{% load static %}

{% if debts %}
    <div class="room-detail-tab-header">
        <h5>Debts</h5>
        <small>
            If you have paid off your debt to someone, click on the white piggy-bank-icon (<i
                class="bi bi-piggy-bank"></i>) next to the debt.
        </small>
    </div>

    <ul class="list-group">
        {% for debitor, debt_entry in debts.items %}
            {% for creditor, amount_owed_debt_ids_and_settled in debt_entry.items %}
                <li class="list-group-item">
                    <div class="row align-items-center">
                        <div class="col-11">
                            {% if amount_owed_debt_ids_and_settled.settled %}
                                <span style="text-decoration: line-through;">
                            {% endif %}

                            {% if debitor == request.user.name %}
                                <span class="me-involved">You</span> owe
                            {% else %}
                                <strong>{{ debitor }}</strong> owes
                            {% endif %}
                            {{ amount_owed_debt_ids_and_settled.amount_owed }}â‚¬ to
                            {% if creditor == request.user.name %}
                                <span class="me-involved">you</span>
                            {% else %}
                                {{ creditor }}
                            {% endif %}

                            {% if amount_owed_debt_ids_and_settled.settled %}
                                </span>
                            {% endif %}
                        </div>

                        <div class="col-1">
                            <div class="float-end">
                                {% if amount_owed_debt_ids_and_settled.settled %}
                                    <i class="bi bi-piggy-bank-fill debt-list-debt-settled"></i>
                                {% else %}
                                    {% if debitor == request.user.name %}
                                        <i class="bi bi-piggy-bank"
                                           data-bs-toggle="modal"
                                           data-bs-target="#settleDebtModal{{ forloop.counter }}"></i>
                                    {% else %}
                                        <i class="bi bi-piggy-bank" style="opacity: 25%; cursor:pointer;"
                                           data-bs-toggle="tooltip"
                                           data-bs-placement="top"
                                           data-bs-title="This transaction is not yours to settle!"></i>
                                    {% endif %}
                                {% endif %}
                            </div>
                        </div>

                        {% include "room/partials/_settle_payment_modal.html" with creditor=creditor debt_ids=amount_owed_debt_ids_and_settled.debt_ids forloop_counter=forloop.counter%}
                    </div>
                </li>
            {% endfor %}
        {% endfor %}
    </ul>
    <br/>

{% endif %}