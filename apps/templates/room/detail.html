{% extends "core/base.html" %}

{% block content %}
    {% if request.user.is_authenticated %}
        <small>Hey {{ request.user.username }}!</small>
    {% endif %}

    <div class="row align-items-center mt-3">
        <div class="col-9 col-md-5">
            <h1>{{ room.name }}</h1>
        </div>
        <div class="col-3 col-md-7">
            <button class="btn btn-light btn-sm float-end me-4"
                    onclick="copyShareURL()"
                    data-bs-toggle="tooltip"
                    data-bs-title="Copy the rooms URL to your clipboard to send it to your friends"
            >
                <i class="bi bi-clipboard2-check-fill"></i>
            </button>
        </div>
    </div>

    <div class="mb-3">
        <small>{{ room.description }}</small>
    </div>

    {% if request.user.is_authenticated %}
        <ul class="nav nav-tabs nav-fill" id="roomTab" role="tablist">

            <li class="nav-item" role="presentation" style="cursor: pointer">
                <a id="transaction-tab" class="nav-link active" data-bs-toggle="tab" data-bs-target="#transactions"
                   role="tab"
                   aria-controls="transactions" aria-selected="true">
                    <i class="bi bi-wallet"></i>
                </a>
            </li>

            <li class="nav-item" role="presentation" style="cursor: pointer">
                <a id="debt-tab" class="nav-link" data-bs-toggle="tab" data-bs-target="#debts" role="tab"
                   aria-controls="debts" aria-selected="false">
                    <i class="bi bi-piggy-bank"></i>
                </a>
            </li>

            <li class="nav-item" role="presentation" style="cursor: pointer">
                <a id="moneyflow-tab" class="nav-link" data-bs-toggle="tab" data-bs-target="#moneyflows" role="tab"
                   aria-controls="moneyflows" aria-selected="false">
                    <i class="bi bi-arrow-left-right"></i>

                </a>
            </li>

            <li class="nav-item" role="presentation" style="cursor: pointer">
                <a id="people-tab" class="nav-link" data-bs-toggle="tab" data-bs-target="#people" role="tab"
                   aria-controls="people" aria-selected="false">
                    <i class="bi bi-people"></i>
                </a>
            </li>

        </ul>

        <div class="tab-content">

            <div class="tab-pane active" id="transactions" role="tabpanel" aria-labelledby="transaction-tab"
                 tabindex="0">
                {% include "room/partials/_room_transactions_list.html" %}
            </div>

            <div class="tab-pane" id="debts" role="tabpanel" aria-labelledby="debt-tab" tabindex="0">
                {% include "room/partials/_debt_list.html" %}
            </div>

            <div class="tab-pane" id="moneyflows" role="tabpanel" aria-labelledby="moneyflow-tab" tabindex="0">
                {% include "room/partials/_money_flow_qs_accordion.html" %}
            </div>

            <div class="tab-pane" id="people" role="tabpanel" aria-labelledby="people-tab" tabindex="0">
                {% include "room/partials/_users_of_room_list.html" %}
            </div>

        </div>

        {% include "room/partials/_add_payment_modal.html" %}

    {% else %}
        {% include "room/partials/_detail_who_are_you.html" %}
    {% endif %}

    <script>
      const copyShareURL = () => {
        const url = document.URL
        navigator.clipboard.writeText(url).then(() => {
          /* clipboard successfully set */
          console.log(`${url} successfully copied to clipboard`)
        }, () => {
          /* clipboard write failed */
          console.error("Something went wrong here")
        });
      }

      const handleTabClick = (elementID) => {
        console.log(elementID)
        const clickedTab = document.getElementById(elementID)
      }
    </script>
{% endblock %}
